<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Zelvora AI</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1f7aff">

<style>
body{margin:0;background:#050b18;color:#fff;font-family:system-ui}
header{padding:16px;font-weight:700;display:flex;justify-content:space-between}
.tabs{display:flex;gap:8px;padding:10px;overflow-x:auto}
.tab{padding:8px 14px;border-radius:20px;background:#111a3a}
.tab.active{background:#1f7aff}
.box{padding:16px}
textarea{width:100%;min-height:90px;background:#111a3a;border:none;color:#fff;padding:12px;border-radius:14px}
button{width:100%;padding:14px;margin-top:10px;border:none;border-radius:14px;background:#1f7aff;color:#fff;font-size:16px}
#reply{margin-top:12px;padding:14px;background:#111a3a;border-radius:14px}
.mic{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);
width:80px;height:80px;border-radius:50%;background:#1f7aff;
display:flex;align-items:center;justify-content:center;font-size:30px}
footer{position:fixed;bottom:0;width:100%;display:flex;justify-content:space-around;
background:#070d20;padding:10px}
</style>
</head>

<body>

<header>
  <div>Zelvora AI</div>
  <div id="status">Online</div>
</header>

<div class="tabs">
  <div class="tab active" data-m="general">General</div>
  <div class="tab" data-m="english">English</div>
  <div class="tab" data-m="academic">Academic</div>
  <div class="tab" data-m="exam">Exam</div>
  <div class="tab" data-m="startup">Startup</div>
</div>

<div class="box">
  <textarea id="q" placeholder="Ask or speak..."></textarea>
  <button onclick="ask()">Ask AI</button>
  <div id="reply"></div>
</div>

<div class="mic" onclick="toggleMic()">ðŸŽ¤</div>

<footer>
  <div>Home</div><div>Tutor</div><div>Voice</div><div>Profile</div>
</footer>

<script>
const API="https://zelvora-ai.zelvora-global.workers.dev";
let mode="general",rec,listen=false,txt="";

document.querySelectorAll(".tab").forEach(t=>{
  t.onclick=()=>{document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
  t.classList.add("active");mode=t.dataset.m;}
});

async function ask(){
  const q=document.getElementById("q").value.trim();
  if(!q)return;
  status.textContent="Thinking...";
  try{
    const r=await fetch(API,{method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({prompt:q,mode})});
    const d=await r.json();
    reply.innerText=d.reply;
    speak(d.reply);
    status.textContent="Online";
  }catch{status.textContent="Offline";}
}

function speak(t){
  const u=new SpeechSynthesisUtterance(t);
  speechSynthesis.speak(u);
}

function toggleMic(){
  if(!("webkitSpeechRecognition"in window))return alert("No mic");
  if(!rec){
    rec=new webkitSpeechRecognition();
    rec.continuous=true;
    rec.interimResults=true;
    rec.onresult=e=>{
      let s="";
      for(let i=e.resultIndex;i<e.results.length;i++)
        s+=e.results[i][0].transcript;
      q.value=s;
    };
  }
  listen?rec.stop():rec.start();
  listen=!listen;
}
if("serviceWorker"in navigator)navigator.serviceWorker.register("sw.js");
</script>
</body>
</html>
